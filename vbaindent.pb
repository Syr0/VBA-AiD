Global NewList VBASyntax.s() ;{ MUST be sorted small to big because of FunctiON <- small causes ucase in long
AddElement(VBASyntax()) : VBASyntax() = "DB"
AddElement(VBASyntax()) : VBASyntax() = "FV"
AddElement(VBASyntax()) : VBASyntax() = "IF"
AddElement(VBASyntax()) : VBASyntax() = "IS"
AddElement(VBASyntax()) : VBASyntax() = "NA"
AddElement(VBASyntax()) : VBASyntax() = "OR"
AddElement(VBASyntax()) : VBASyntax() = "ON"
AddElement(VBASyntax()) : VBASyntax() = "PI"
AddElement(VBASyntax()) : VBASyntax() = "PV"
AddElement(VBASyntax()) : VBASyntax() = "For"
AddElement(VBASyntax()) : VBASyntax() = "Sub"
AddElement(VBASyntax()) : VBASyntax() = "Dim"
AddElement(VBASyntax()) : VBASyntax() = "Set"
AddElement(VBASyntax()) : VBASyntax() = "End"
AddElement(VBASyntax()) : VBASyntax() = "ABS"
AddElement(VBASyntax()) : VBASyntax() = "AND"
AddElement(VBASyntax()) : VBASyntax() = "ASC"
AddElement(VBASyntax()) : VBASyntax() = "COS"
AddElement(VBASyntax()) : VBASyntax() = "COT"
AddElement(VBASyntax()) : VBASyntax() = "CSC"
AddElement(VBASyntax()) : VBASyntax() = "DAY"
AddElement(VBASyntax()) : VBASyntax() = "DDB"
AddElement(VBASyntax()) : VBASyntax() = "ERF"
AddElement(VBASyntax()) : VBASyntax() = "EXP"
AddElement(VBASyntax()) : VBASyntax() = "END"
AddElement(VBASyntax()) : VBASyntax() = "FIX"
AddElement(VBASyntax()) : VBASyntax() = "FOR"
AddElement(VBASyntax()) : VBASyntax() = "GCD"
AddElement(VBASyntax()) : VBASyntax() = "IFS"
AddElement(VBASyntax()) : VBASyntax() = "INT"
AddElement(VBASyntax()) : VBASyntax() = "IRR"
AddElement(VBASyntax()) : VBASyntax() = "JIS"
AddElement(VBASyntax()) : VBASyntax() = "LCM"
AddElement(VBASyntax()) : VBASyntax() = "LEN"
AddElement(VBASyntax()) : VBASyntax() = "LOG"
AddElement(VBASyntax()) : VBASyntax() = "MAX"
AddElement(VBASyntax()) : VBASyntax() = "MID"
AddElement(VBASyntax()) : VBASyntax() = "MIN"
AddElement(VBASyntax()) : VBASyntax() = "MOD"
AddElement(VBASyntax()) : VBASyntax() = "NOT"
AddElement(VBASyntax()) : VBASyntax() = "NOW"
AddElement(VBASyntax()) : VBASyntax() = "NPV"
AddElement(VBASyntax()) : VBASyntax() = "ODD"
AddElement(VBASyntax()) : VBASyntax() = "PHI"
AddElement(VBASyntax()) : VBASyntax() = "PMT"
AddElement(VBASyntax()) : VBASyntax() = "PUT"
AddElement(VBASyntax()) : VBASyntax() = "ROW"
AddElement(VBASyntax()) : VBASyntax() = "RRI"
AddElement(VBASyntax()) : VBASyntax() = "RSQ"
AddElement(VBASyntax()) : VBASyntax() = "RTD"
AddElement(VBASyntax()) : VBASyntax() = "SEC"
AddElement(VBASyntax()) : VBASyntax() = "SIN"
AddElement(VBASyntax()) : VBASyntax() = "SET"
AddElement(VBASyntax()) : VBASyntax() = "SLN"
AddElement(VBASyntax()) : VBASyntax() = "STR"
AddElement(VBASyntax()) : VBASyntax() = "SUM"
AddElement(VBASyntax()) : VBASyntax() = "SYD"
AddElement(VBASyntax()) : VBASyntax() = "TAN"
AddElement(VBASyntax()) : VBASyntax() = "VAL"
AddElement(VBASyntax()) : VBASyntax() = "VDB"
AddElement(VBASyntax()) : VBASyntax() = "XOR"
AddElement(VBASyntax()) : VBASyntax() = "EXIT"
AddElement(VBASyntax()) : VBASyntax() = "ELSE"
AddElement(VBASyntax()) : VBASyntax() = "ACOS"
AddElement(VBASyntax()) : VBASyntax() = "ACOT"
AddElement(VBASyntax()) : VBASyntax() = "ASIN"
AddElement(VBASyntax()) : VBASyntax() = "BASE"
AddElement(VBASyntax()) : VBASyntax() = "CALL"
AddElement(VBASyntax()) : VBASyntax() = "Case"
AddElement(VBASyntax()) : VBASyntax() = "CELL"
AddElement(VBASyntax()) : VBASyntax() = "CODE"
AddElement(VBASyntax()) : VBASyntax() = "COSH"
AddElement(VBASyntax()) : VBASyntax() = "COTH"
AddElement(VBASyntax()) : VBASyntax() = "CSCH"
AddElement(VBASyntax()) : VBASyntax() = "DAYS"
AddElement(VBASyntax()) : VBASyntax() = "DBCS"
AddElement(VBASyntax()) : VBASyntax() = "DGET"
AddElement(VBASyntax()) : VBASyntax() = "DISC"
AddElement(VBASyntax()) : VBASyntax() = "DMAX"
AddElement(VBASyntax()) : VBASyntax() = "DMIN"
AddElement(VBASyntax()) : VBASyntax() = "DSUM"
AddElement(VBASyntax()) : VBASyntax() = "DVAR"
AddElement(VBASyntax()) : VBASyntax() = "EVEN"
AddElement(VBASyntax()) : VBASyntax() = "FACT"
AddElement(VBASyntax()) : VBASyntax() = "FIND"
AddElement(VBASyntax()) : VBASyntax() = "HOUR"
AddElement(VBASyntax()) : VBASyntax() = "IFNA"
AddElement(VBASyntax()) : VBASyntax() = "IMLN"
AddElement(VBASyntax()) : VBASyntax() = "INFO"
AddElement(VBASyntax()) : VBASyntax() = "IPMT"
AddElement(VBASyntax()) : VBASyntax() = "ISNA"
AddElement(VBASyntax()) : VBASyntax() = "JOIN"
AddElement(VBASyntax()) : VBASyntax() = "KURT"
AddElement(VBASyntax()) : VBASyntax() = "LEFT"
AddElement(VBASyntax()) : VBASyntax() = "LSET"
AddElement(VBASyntax()) : VBASyntax() = "MAXA"
AddElement(VBASyntax()) : VBASyntax() = "MINA"
AddElement(VBASyntax()) : VBASyntax() = "MIRR"
AddElement(VBASyntax()) : VBASyntax() = "NEXT"
AddElement(VBASyntax()) : VBASyntax() = "MAIN"
AddElement(VBASyntax()) : VBASyntax() = "NPER"
AddElement(VBASyntax()) : VBASyntax() = "PPMT"
AddElement(VBASyntax()) : VBASyntax() = "PROB"
AddElement(VBASyntax()) : VBASyntax() = "RATE"
AddElement(VBASyntax()) : VBASyntax() = "REPT"
AddElement(VBASyntax()) : VBASyntax() = "ROWS"
AddElement(VBASyntax()) : VBASyntax() = "RSET"
AddElement(VBASyntax()) : VBASyntax() = "SECH"
AddElement(VBASyntax()) : VBASyntax() = "SINH"
AddElement(VBASyntax()) : VBASyntax() = "SKEW"
AddElement(VBASyntax()) : VBASyntax() = "TANH"
AddElement(VBASyntax()) : VBASyntax() = "TEXT"
AddElement(VBASyntax()) : VBASyntax() = "THEN"
AddElement(VBASyntax()) : VBASyntax() = "TRIM"
AddElement(VBASyntax()) : VBASyntax() = "THIS"
AddElement(VBASyntax()) : VBASyntax() = "TRUE"
AddElement(VBASyntax()) : VBASyntax() = "TYPE"
AddElement(VBASyntax()) : VBASyntax() = "VARA"
AddElement(VBASyntax()) : VBASyntax() = "XIRR"
AddElement(VBASyntax()) : VBASyntax() = "XNPV"
AddElement(VBASyntax()) : VBASyntax() = "YEAR"
AddElement(VBASyntax()) : VBASyntax() = "CLNG"
AddElement(VBASyntax()) : VBASyntax() = "DATE"
AddElement(VBASyntax()) : VBASyntax() = "CLEAR"
AddElement(VBASyntax()) : VBASyntax() = "ACOSH"
AddElement(VBASyntax()) : VBASyntax() = "ACOTH"
AddElement(VBASyntax()) : VBASyntax() = "AREAS"
AddElement(VBASyntax()) : VBASyntax() = "ASINH"
AddElement(VBASyntax()) : VBASyntax() = "ATAN2"
AddElement(VBASyntax()) : VBASyntax() = "ATANH"
AddElement(VBASyntax()) : VBASyntax() = "BITOR"
AddElement(VBASyntax()) : VBASyntax() = "CLEAN"
AddElement(VBASyntax()) : VBASyntax() = "COUNT"
AddElement(VBASyntax()) : VBASyntax() = "DELTA"
AddElement(VBASyntax()) : VBASyntax() = "DEVSQ"
AddElement(VBASyntax()) : VBASyntax() = "DVARP"
AddElement(VBASyntax()) : VBASyntax() = "EDATE"
AddElement(VBASyntax()) : VBASyntax() = "ERROR"
AddElement(VBASyntax()) : VBASyntax() = "EXACT"
AddElement(VBASyntax()) : VBASyntax() = "F.INV"
AddElement(VBASyntax()) : VBASyntax() = "FALSE"
AddElement(VBASyntax()) : VBASyntax() = "FIXED"
AddElement(VBASyntax()) : VBASyntax() = "GAMMA"
AddElement(VBASyntax()) : VBASyntax() = "GAUSS"
AddElement(VBASyntax()) : VBASyntax() = "IMABS"
AddElement(VBASyntax()) : VBASyntax() = "IMCOS"
AddElement(VBASyntax()) : VBASyntax() = "IMCOT"
AddElement(VBASyntax()) : VBASyntax() = "IMCSC"
AddElement(VBASyntax()) : VBASyntax() = "IMDIV"
AddElement(VBASyntax()) : VBASyntax() = "IMEXP"
AddElement(VBASyntax()) : VBASyntax() = "IMSEC"
AddElement(VBASyntax()) : VBASyntax() = "IMSIN"
AddElement(VBASyntax()) : VBASyntax() = "IMSUB"
AddElement(VBASyntax()) : VBASyntax() = "IMSUM"
AddElement(VBASyntax()) : VBASyntax() = "IMTAN"
AddElement(VBASyntax()) : VBASyntax() = "INDEX"
AddElement(VBASyntax()) : VBASyntax() = "INPUT"
AddElement(VBASyntax()) : VBASyntax() = "INPUT"
AddElement(VBASyntax()) : VBASyntax() = "INSTR"
AddElement(VBASyntax()) : VBASyntax() = "ISERR"
AddElement(VBASyntax()) : VBASyntax() = "ISODD"
AddElement(VBASyntax()) : VBASyntax() = "ISPMT"
AddElement(VBASyntax()) : VBASyntax() = "ISREF"
AddElement(VBASyntax()) : VBASyntax() = "LARGE"
AddElement(VBASyntax()) : VBASyntax() = "LCASE"
AddElement(VBASyntax()) : VBASyntax() = "LOG10"
AddElement(VBASyntax()) : VBASyntax() = "LOWER"
AddElement(VBASyntax()) : VBASyntax() = "LTRIM"
AddElement(VBASyntax()) : VBASyntax() = "MATCH"
AddElement(VBASyntax()) : VBASyntax() = "MMULT"
AddElement(VBASyntax()) : VBASyntax() = "MONTH"
AddElement(VBASyntax()) : VBASyntax() = "MUNIT"
AddElement(VBASyntax()) : VBASyntax() = "POWER"
AddElement(VBASyntax()) : VBASyntax() = "PRICE"
AddElement(VBASyntax()) : VBASyntax() = "PRINT"
AddElement(VBASyntax()) : VBASyntax() = "RIGHT"
AddElement(VBASyntax()) : VBASyntax() = "CONST"
AddElement(VBASyntax()) : VBASyntax() = "ROMAN"
AddElement(VBASyntax()) : VBASyntax() = "ROUND"
AddElement(VBASyntax()) : VBASyntax() = "RTRIM"
AddElement(VBASyntax()) : VBASyntax() = "SHEET"
AddElement(VBASyntax()) : VBASyntax() = "SHELL"
AddElement(VBASyntax()) : VBASyntax() = "SLOPE"
AddElement(VBASyntax()) : VBASyntax() = "SMALL"
AddElement(VBASyntax()) : VBASyntax() = "SPACE"
AddElement(VBASyntax()) : VBASyntax() = "SPLIT"
AddElement(VBASyntax()) : VBASyntax() = "STEYX"
AddElement(VBASyntax()) : VBASyntax() = "SUMIF"
AddElement(VBASyntax()) : VBASyntax() = "SUMSQ"
AddElement(VBASyntax()) : VBASyntax() = "T.INV"
AddElement(VBASyntax()) : VBASyntax() = "TIMER"
AddElement(VBASyntax()) : VBASyntax() = "TREND"
AddElement(VBASyntax()) : VBASyntax() = "TRUNC"
AddElement(VBASyntax()) : VBASyntax() = "VALUE"
AddElement(VBASyntax()) : VBASyntax() = "VAR.P"
AddElement(VBASyntax()) : VBASyntax() = "VAR.S"
AddElement(VBASyntax()) : VBASyntax() = "VARPA"
AddElement(VBASyntax()) : VBASyntax() = "YIELD"
AddElement(VBASyntax()) : VBASyntax() = "WHILE"
AddElement(VBASyntax()) : VBASyntax() = "WRITE"
AddElement(VBASyntax()) : VBASyntax() = "SELECT"
AddElement(VBASyntax()) : VBASyntax() = "ARABIC"
AddElement(VBASyntax()) : VBASyntax() = "AVEDEV"
AddElement(VBASyntax()) : VBASyntax() = "BITAND"
AddElement(VBASyntax()) : VBASyntax() = "BITXOR"
AddElement(VBASyntax()) : VBASyntax() = "CHOOSE"
AddElement(VBASyntax()) : VBASyntax() = "COLUMN"
AddElement(VBASyntax()) : VBASyntax() = "COMBIN"
AddElement(VBASyntax()) : VBASyntax() = "CORREL"
AddElement(VBASyntax()) : VBASyntax() = "COUNTA"
AddElement(VBASyntax()) : VBASyntax() = "DCOUNT"
AddElement(VBASyntax()) : VBASyntax() = "DOLLAR"
AddElement(VBASyntax()) : VBASyntax() = "DSTDEV"
AddElement(VBASyntax()) : VBASyntax() = "EFFECT"
AddElement(VBASyntax()) : VBASyntax() = "F.DIST"
AddElement(VBASyntax()) : VBASyntax() = "Server"
AddElement(VBASyntax()) : VBASyntax() = "F.TEST"
AddElement(VBASyntax()) : VBASyntax() = "FILTER"
AddElement(VBASyntax()) : VBASyntax() = "FISHER"
AddElement(VBASyntax()) : VBASyntax() = "FORMAT"
AddElement(VBASyntax()) : VBASyntax() = "GESTEP"
AddElement(VBASyntax()) : VBASyntax() = "GROWTH"
AddElement(VBASyntax()) : VBASyntax() = "IMCOSH"
AddElement(VBASyntax()) : VBASyntax() = "IMCSCH"
AddElement(VBASyntax()) : VBASyntax() = "IMLOG2"
AddElement(VBASyntax()) : VBASyntax() = "IMREAL"
AddElement(VBASyntax()) : VBASyntax() = "IMSECH"
AddElement(VBASyntax()) : VBASyntax() = "IMSINH"
AddElement(VBASyntax()) : VBASyntax() = "IMSQRT"
AddElement(VBASyntax()) : VBASyntax() = "ISDATE"
AddElement(VBASyntax()) : VBASyntax() = "ISEVEN"
AddElement(VBASyntax()) : VBASyntax() = "ISNULL"
AddElement(VBASyntax()) : VBASyntax() = "ISTEXT"
AddElement(VBASyntax()) : VBASyntax() = "LINEST"
AddElement(VBASyntax()) : VBASyntax() = "LOGEST"
AddElement(VBASyntax()) : VBASyntax() = "LOOKUP"
AddElement(VBASyntax()) : VBASyntax() = "MAXIFS"
AddElement(VBASyntax()) : VBASyntax() = "MEDIAN"
AddElement(VBASyntax()) : VBASyntax() = "MINIFS"
AddElement(VBASyntax()) : VBASyntax() = "MINUTE"
AddElement(VBASyntax()) : VBASyntax() = "MROUND"
AddElement(VBASyntax()) : VBASyntax() = "OFFSET"
AddElement(VBASyntax()) : VBASyntax() = "PERMUT"
AddElement(VBASyntax()) : VBASyntax() = "PROPER"
AddElement(VBASyntax()) : VBASyntax() = "RESUME"
AddElement(VBASyntax()) : VBASyntax() = "SEARCH"
AddElement(VBASyntax()) : VBASyntax() = "SECOND"
AddElement(VBASyntax()) : VBASyntax() = "SHEETS"
AddElement(VBASyntax()) : VBASyntax() = "SKEW.P"
AddElement(VBASyntax()) : VBASyntax() = "SQRTPI"
AddElement(VBASyntax()) : VBASyntax() = "STDEVA"
AddElement(VBASyntax()) : VBASyntax() = "STRING"
AddElement(VBASyntax()) : VBASyntax() = "SUMIFS"
AddElement(VBASyntax()) : VBASyntax() = "SWITCH"
AddElement(VBASyntax()) : VBASyntax() = "T.DIST"
AddElement(VBASyntax()) : VBASyntax() = "T.TEST"
AddElement(VBASyntax()) : VBASyntax() = "Z.TEST"
AddElement(VBASyntax()) : VBASyntax() = "COOKIE"
AddElement(VBASyntax()) : VBASyntax() = "PUBLIC"
AddElement(VBASyntax()) : VBASyntax() = "PRIVATE"
AddElement(VBASyntax()) : VBASyntax() = "ACCRINT"
AddElement(VBASyntax()) : VBASyntax() = "ADDRESS"
AddElement(VBASyntax()) : VBASyntax() = "AVERAGE"
AddElement(VBASyntax()) : VBASyntax() = "BESSELI"
AddElement(VBASyntax()) : VBASyntax() = "BESSELJ"
AddElement(VBASyntax()) : VBASyntax() = "BESSELK"
AddElement(VBASyntax()) : VBASyntax() = "BESSELY"
AddElement(VBASyntax()) : VBASyntax() = "SESSION"
AddElement(VBASyntax()) : VBASyntax() = "BIN2DEC"
AddElement(VBASyntax()) : VBASyntax() = "COLUMNS"
AddElement(VBASyntax()) : VBASyntax() = "COMBINA"
AddElement(VBASyntax()) : VBASyntax() = "COMMAND"
AddElement(VBASyntax()) : VBASyntax() = "COMPLEX"
AddElement(VBASyntax()) : VBASyntax() = "CONVERT"
AddElement(VBASyntax()) : VBASyntax() = "COUNTIF"
AddElement(VBASyntax()) : VBASyntax() = "COUPNCD"
AddElement(VBASyntax()) : VBASyntax() = "COUPNUM"
AddElement(VBASyntax()) : VBASyntax() = "COUPPCD"
AddElement(VBASyntax()) : VBASyntax() = "CUBESET"
AddElement(VBASyntax()) : VBASyntax() = "CUMIPMT"
AddElement(VBASyntax()) : VBASyntax() = "DATEADD"
AddElement(VBASyntax()) : VBASyntax() = "DAYS360"
AddElement(VBASyntax()) : VBASyntax() = "DCOUNTA"
AddElement(VBASyntax()) : VBASyntax() = "DEC2BIN"
AddElement(VBASyntax()) : VBASyntax() = "DEC2HEX"
AddElement(VBASyntax()) : VBASyntax() = "DEC2OCT"
AddElement(VBASyntax()) : VBASyntax() = "DECIMAL"
AddElement(VBASyntax()) : VBASyntax() = "DEGREES"
AddElement(VBASyntax()) : VBASyntax() = "DSTDEVP"
AddElement(VBASyntax()) : VBASyntax() = "EOMONTH"
AddElement(VBASyntax()) : VBASyntax() = "GEOMEAN"
AddElement(VBASyntax()) : VBASyntax() = "HARMEAN"
AddElement(VBASyntax()) : VBASyntax() = "HEX2BIN"
AddElement(VBASyntax()) : VBASyntax() = "HEX2DEC"
AddElement(VBASyntax()) : VBASyntax() = "HEX2OCT"
AddElement(VBASyntax()) : VBASyntax() = "HLOOKUP"
AddElement(VBASyntax()) : VBASyntax() = "IFERROR"
AddElement(VBASyntax()) : VBASyntax() = "IMLOG10"
AddElement(VBASyntax()) : VBASyntax() = "IMPOWER"
AddElement(VBASyntax()) : VBASyntax() = "INTRATE"
AddElement(VBASyntax()) : VBASyntax() = "ISARRAY"
AddElement(VBASyntax()) : VBASyntax() = "ISBLANK"
AddElement(VBASyntax()) : VBASyntax() = "ISEMPTY"
AddElement(VBASyntax()) : VBASyntax() = "ISERROR"
AddElement(VBASyntax()) : VBASyntax() = "MDETERM"
AddElement(VBASyntax()) : VBASyntax() = "NOMINAL"
AddElement(VBASyntax()) : VBASyntax() = "Nothing"
AddElement(VBASyntax()) : VBASyntax() = "OCT2BIN"
AddElement(VBASyntax()) : VBASyntax() = "OCT2DEC"
AddElement(VBASyntax()) : VBASyntax() = "OCT2HEX"
AddElement(VBASyntax()) : VBASyntax() = "PEARSON"
AddElement(VBASyntax()) : VBASyntax() = "PRODUCT"
AddElement(VBASyntax()) : VBASyntax() = "QBCOLOR"
AddElement(VBASyntax()) : VBASyntax() = "RADIANS"
AddElement(VBASyntax()) : VBASyntax() = "RANK.EQ"
AddElement(VBASyntax()) : VBASyntax() = "REPLACE"
AddElement(VBASyntax()) : VBASyntax() = "REQUEST"
AddElement(VBASyntax()) : VBASyntax() = "ROUNDUP"
AddElement(VBASyntax()) : VBASyntax() = "SETATTR"
AddElement(VBASyntax()) : VBASyntax() = "STDEV.P"
AddElement(VBASyntax()) : VBASyntax() = "STDEV.S"
AddElement(VBASyntax()) : VBASyntax() = "STDEVPA"
AddElement(VBASyntax()) : VBASyntax() = "STRCOMP"
AddElement(VBASyntax()) : VBASyntax() = "STRCONV"
AddElement(VBASyntax()) : VBASyntax() = "SUMXMY2"
AddElement(VBASyntax()) : VBASyntax() = "TBILLEQ"
AddElement(VBASyntax()) : VBASyntax() = "UNICHAR"
AddElement(VBASyntax()) : VBASyntax() = "UNICODE"
AddElement(VBASyntax()) : VBASyntax() = "VLOOKUP"
AddElement(VBASyntax()) : VBASyntax() = "WEEKDAY"
AddElement(VBASyntax()) : VBASyntax() = "WEEKNUM"
AddElement(VBASyntax()) : VBASyntax() = "TIMEOUT"
AddElement(VBASyntax()) : VBASyntax() = "CHARSET"
AddElement(VBASyntax()) : VBASyntax() = "COOKIES"
AddElement(VBASyntax()) : VBASyntax() = "PASSWORD"
AddElement(VBASyntax()) : VBASyntax() = "RESPONSE"
AddElement(VBASyntax()) : VBASyntax() = "ACCRINTM"
AddElement(VBASyntax()) : VBASyntax() = "AMORLINC"
AddElement(VBASyntax()) : VBASyntax() = "AVERAGEA"
AddElement(VBASyntax()) : VBASyntax() = "BAHTTEXT"
AddElement(VBASyntax()) : VBASyntax() = "BETA.INV"
AddElement(VBASyntax()) : VBASyntax() = "COUNTIFS"
AddElement(VBASyntax()) : VBASyntax() = "COUPDAYS"
AddElement(VBASyntax()) : VBASyntax() = "CUMPRINC"
AddElement(VBASyntax()) : VBASyntax() = "DATEDIFF"
AddElement(VBASyntax()) : VBASyntax() = "DATEPART"
AddElement(VBASyntax()) : VBASyntax() = "DAVERAGE"
AddElement(VBASyntax()) : VBASyntax() = "DOLLARDE"
AddElement(VBASyntax()) : VBASyntax() = "DOLLARFR"
AddElement(VBASyntax()) : VBASyntax() = "DPRODUCT"
AddElement(VBASyntax()) : VBASyntax() = "DURATION"
AddElement(VBASyntax()) : VBASyntax() = "F.INV.RT"
AddElement(VBASyntax()) : VBASyntax() = "FORECAST"
AddElement(VBASyntax()) : VBASyntax() = "FUNCTION"
AddElement(VBASyntax()) : VBASyntax() = "INDIRECT"
AddElement(VBASyntax()) : VBASyntax() = "INSTRREV"
AddElement(VBASyntax()) : VBASyntax() = "ISNUMBER"
AddElement(VBASyntax()) : VBASyntax() = "ISOBJECT"
AddElement(VBASyntax()) : VBASyntax() = "MINVERSE"
AddElement(VBASyntax()) : VBASyntax() = "NORM.INV"
AddElement(VBASyntax()) : VBASyntax() = "PHONETIC"
AddElement(VBASyntax()) : VBASyntax() = "PRICEMAT"
AddElement(VBASyntax()) : VBASyntax() = "QUOTIENT"
AddElement(VBASyntax()) : VBASyntax() = "RANK.AVG"
AddElement(VBASyntax()) : VBASyntax() = "RECEIVED"
AddElement(VBASyntax()) : VBASyntax() = "SENDKEYS"
AddElement(VBASyntax()) : VBASyntax() = "SUBTOTAL"
AddElement(VBASyntax()) : VBASyntax() = "SUMX2MY2"
AddElement(VBASyntax()) : VBASyntax() = "SUMX2PY2"
AddElement(VBASyntax()) : VBASyntax() = "T.INV.2T"
AddElement(VBASyntax()) : VBASyntax() = "TEXTJOIN"
AddElement(VBASyntax()) : VBASyntax() = "TRIMMEAN"
AddElement(VBASyntax()) : VBASyntax() = "YEARFRAC"
AddElement(VBASyntax()) : VBASyntax() = "YIELDMAT"
AddElement(VBASyntax()) : VBASyntax() = "readline"
AddElement(VBASyntax()) : VBASyntax() = "RANDOMIZE"
AddElement(VBASyntax()) : VBASyntax() = "AGGREGATE"
AddElement(VBASyntax()) : VBASyntax() = "AMORDEGRC"
AddElement(VBASyntax()) : VBASyntax() = "AVERAGEIF"
AddElement(VBASyntax()) : VBASyntax() = "BETA.DIST"
AddElement(VBASyntax()) : VBASyntax() = "BINOM.INV"
AddElement(VBASyntax()) : VBASyntax() = "BITLSHIFT"
AddElement(VBASyntax()) : VBASyntax() = "BITRSHIFT"
AddElement(VBASyntax()) : VBASyntax() = "CHISQ.INV"
AddElement(VBASyntax()) : VBASyntax() = "COUPDAYBS"
AddElement(VBASyntax()) : VBASyntax() = "CRITBINOM"
AddElement(VBASyntax()) : VBASyntax() = "CUBEVALUE"
AddElement(VBASyntax()) : VBASyntax() = "DATEVALUE"
AddElement(VBASyntax()) : VBASyntax() = "ENCODEURL"
AddElement(VBASyntax()) : VBASyntax() = "F.DIST.RT"
AddElement(VBASyntax()) : VBASyntax() = "FILTERXML"
AddElement(VBASyntax()) : VBASyntax() = "FISHERINV"
AddElement(VBASyntax()) : VBASyntax() = "FREQUENCY"
AddElement(VBASyntax()) : VBASyntax() = "FREQUENCY"
AddElement(VBASyntax()) : VBASyntax() = "GAMMA.INV"
AddElement(VBASyntax()) : VBASyntax() = "HYPERLINK"
AddElement(VBASyntax()) : VBASyntax() = "IMAGINARY"
AddElement(VBASyntax()) : VBASyntax() = "IMPRODUCT"
AddElement(VBASyntax()) : VBASyntax() = "INTERCEPT"
AddElement(VBASyntax()) : VBASyntax() = "ISFORMULA"
AddElement(VBASyntax()) : VBASyntax() = "ISLOGICAL"
AddElement(VBASyntax()) : VBASyntax() = "ISMISSING"
AddElement(VBASyntax()) : VBASyntax() = "ISNONTEXT"
AddElement(VBASyntax()) : VBASyntax() = "ISNUMERIC"
AddElement(VBASyntax()) : VBASyntax() = "MDURATION"
AddElement(VBASyntax()) : VBASyntax() = "MODE.MULT"
AddElement(VBASyntax()) : VBASyntax() = "MODE.SNGL"
AddElement(VBASyntax()) : VBASyntax() = "MONTHNAME"
AddElement(VBASyntax()) : VBASyntax() = "NORM.DIST"
AddElement(VBASyntax()) : VBASyntax() = "ODDFPRICE"
AddElement(VBASyntax()) : VBASyntax() = "ODDFYIELD"
AddElement(VBASyntax()) : VBASyntax() = "ODDLPRICE"
AddElement(VBASyntax()) : VBASyntax() = "ODDLYIELD"
AddElement(VBASyntax()) : VBASyntax() = "PARTITION"
AddElement(VBASyntax()) : VBASyntax() = "PDURATION"
AddElement(VBASyntax()) : VBASyntax() = "PRICEDISC"
AddElement(VBASyntax()) : VBASyntax() = "ROUNDDOWN"
AddElement(VBASyntax()) : VBASyntax() = "SERIESSUM"
AddElement(VBASyntax()) : VBASyntax() = "T.DIST.2T"
AddElement(VBASyntax()) : VBASyntax() = "T.DIST.RT"
AddElement(VBASyntax()) : VBASyntax() = "TIMEVALUE"
AddElement(VBASyntax()) : VBASyntax() = "TRANSPOSE"
AddElement(VBASyntax()) : VBASyntax() = "YIELDDISC"
AddElement(VBASyntax()) : VBASyntax() = "AVERAGEIFS"
AddElement(VBASyntax()) : VBASyntax() = "BINOM.DIST"
AddElement(VBASyntax()) : VBASyntax() = "CHISQ.DIST"
AddElement(VBASyntax()) : VBASyntax() = "CHISQ.TEST"
AddElement(VBASyntax()) : VBASyntax() = "COUNTBLANK"
AddElement(VBASyntax()) : VBASyntax() = "COUPDAYSNC"
AddElement(VBASyntax()) : VBASyntax() = "CUBEMEMBER"
AddElement(VBASyntax()) : VBASyntax() = "EXPON.DIST"
AddElement(VBASyntax()) : VBASyntax() = "FACTDOUBLE"
AddElement(VBASyntax()) : VBASyntax() = "FLOOR.MATH"
AddElement(VBASyntax()) : VBASyntax() = "GAMMA.DIST"
AddElement(VBASyntax()) : VBASyntax() = "IMARGUMENT"
AddElement(VBASyntax()) : VBASyntax() = "ISOWEEKNUM"
AddElement(VBASyntax()) : VBASyntax() = "NORM.S.INV"
AddElement(VBASyntax()) : VBASyntax() = "STRREVERSE"
AddElement(VBASyntax()) : VBASyntax() = "SUBSTITUTE"
AddElement(VBASyntax()) : VBASyntax() = "SUMPRODUCT"
AddElement(VBASyntax()) : VBASyntax() = "TBILLPRICE"
AddElement(VBASyntax()) : VBASyntax() = "TBILLYIELD"
AddElement(VBASyntax()) : VBASyntax() = "WEBSERVICE"
AddElement(VBASyntax()) : VBASyntax() = "CONCATENATE"
AddElement(VBASyntax()) : VBASyntax() = "ERF.PRECISE"
AddElement(VBASyntax()) : VBASyntax() = "EUROCONVERT"
AddElement(VBASyntax()) : VBASyntax() = "FORMULATEXT"
AddElement(VBASyntax()) : VBASyntax() = "IMCONJUGATE"
AddElement(VBASyntax()) : VBASyntax() = "ISO.CEILING"
AddElement(VBASyntax()) : VBASyntax() = "LOGNORM.INV"
AddElement(VBASyntax()) : VBASyntax() = "MULTINOMIAL"
AddElement(VBASyntax()) : VBASyntax() = "NORM.S.DIST"
AddElement(VBASyntax()) : VBASyntax() = "NUMBERVALUE"
AddElement(VBASyntax()) : VBASyntax() = "RANDBETWEEN"
AddElement(VBASyntax()) : VBASyntax() = "STANDARDIZE"
AddElement(VBASyntax()) : VBASyntax() = "WEEKDAYNAME"
AddElement(VBASyntax()) : VBASyntax() = "createobject"
AddElement(VBASyntax()) : VBASyntax() = "opentextfile"
AddElement(VBASyntax()) : VBASyntax() = "CEILING.MATH"
AddElement(VBASyntax()) : VBASyntax() = "CHISQ.INV.RT"
AddElement(VBASyntax()) : VBASyntax() = "CONFIDENCE.T"
AddElement(VBASyntax()) : VBASyntax() = "COVARIANCE.P"
AddElement(VBASyntax()) : VBASyntax() = "COVARIANCE.S"
AddElement(VBASyntax()) : VBASyntax() = "CUBESETCOUNT"
AddElement(VBASyntax()) : VBASyntax() = "ERFC.PRECISE"
AddElement(VBASyntax()) : VBASyntax() = "FORECAST.ETS"
AddElement(VBASyntax()) : VBASyntax() = "FORMATNUMBER"
AddElement(VBASyntax()) : VBASyntax() = "GETPIVOTDATA"
AddElement(VBASyntax()) : VBASyntax() = "HYPGEOM.DIST"
AddElement(VBASyntax()) : VBASyntax() = "LOGNORM.DIST"
AddElement(VBASyntax()) : VBASyntax() = "PERMUTATIONA"
AddElement(VBASyntax()) : VBASyntax() = "POISSON.DIST"
AddElement(VBASyntax()) : VBASyntax() = "QUARTILE.EXC"
AddElement(VBASyntax()) : VBASyntax() = "QUARTILE.INC"
AddElement(VBASyntax()) : VBASyntax() = "WEIBULL.DIST"
AddElement(VBASyntax()) : VBASyntax() = "WORKDAY.INTL"
AddElement(VBASyntax()) : VBASyntax() = "CHISQ.DIST.RT"
AddElement(VBASyntax()) : VBASyntax() = "CUBEKPIMEMBER"
AddElement(VBASyntax()) : VBASyntax() = "FLOOR.PRECISE"
AddElement(VBASyntax()) : VBASyntax() = "FORMATPERCENT"
AddElement(VBASyntax()) : VBASyntax() = "NEGBINOM.DIST"
AddElement(VBASyntax()) : VBASyntax() = "ATENDOFSTREAM"
AddElement(VBASyntax()) : VBASyntax() = "FORMATCURRENCY"
AddElement(VBASyntax()) : VBASyntax() = "FORMATDATETIME"
AddElement(VBASyntax()) : VBASyntax() = "PERCENTILE.EXC"
AddElement(VBASyntax()) : VBASyntax() = "PERCENTILE.INC"
AddElement(VBASyntax()) : VBASyntax() = "CONFIDENCE.NORM"
AddElement(VBASyntax()) : VBASyntax() = "FORECAST.LINEAR"
AddElement(VBASyntax()) : VBASyntax() = "GAMMALN.PRECISE"
AddElement(VBASyntax()) : VBASyntax() = "PERCENTRANK.EXC"
AddElement(VBASyntax()) : VBASyntax() = "PERCENTRANK.INC"
AddElement(VBASyntax()) : VBASyntax() = "serverVaRiaBlEs"
AddElement(VBASyntax()) : VBASyntax() = "BINOM.DIST.RANGE"
AddElement(VBASyntax()) : VBASyntax() = "NETWORKDAYS.INTL" ;}

Global NewList VBABasicSyntax.s() ;{
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "If"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "For"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "Sub"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "Dim"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "Set"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "End"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "Const"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "Class"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "Else"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "Next"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "Case"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "Select"
AddElement(VBABasicSyntax()) : VBABasicSyntax() = "Function" ;}

Procedure.s ULcase(text$)
  text$ = LCase(text$)
  text$ = UCase(Left(text$,1))+Mid(text$,2)
  ProcedureReturn text$
EndProcedure

Global NewMap Switches()

Procedure.s Indent(Text$,StartKeyWord.s,EndKeyword.s,SecondStartKeyword.s="",SecondEndKeyword.s="",Exclude$="",NrOfIndents=1)
  
  If FindString(Text$,EndKeyword,0,#PB_String_NoCase)
    If Len(SecondEndKeyword) > 0
      If FindString(Text$,SecondEndKeyword,0,#PB_String_NoCase)
        Switches(StartKeyWord+EndKeyword) -1 : If Switches(StartKeyWord+EndKeyword) < 0: Switches(StartKeyWord+EndKeyword) = 0:EndIf
      EndIf
    Else 
      Switches(StartKeyWord+EndKeyword) -1 : If Switches(StartKeyWord+EndKeyword) < 0: Switches(StartKeyWord+EndKeyword) = 0:EndIf
    EndIf
  EndIf
  If Len(Exclude$)> 0 And FindString(Trim(Text$,Chr(9)),Exclude$,0,#PB_String_NoCase)= 1
    excludeMove = 1
  Else
    excludemove = 0
  EndIf
  
  If Switches(StartKeyWord+EndKeyword)> 0
    For y = 1 To NrOfIndents
      For x = 1 To Switches(StartKeyWord+EndKeyword)-excludeMove
        Text$ = Chr(9)+Text$
      Next
    Next
  EndIf
  
  If FindString(Trim(Text$,Chr(9)),StartKeyWord,0,#PB_String_NoCase)= 1 And Not FindString(Text$,EndKeyword,0,#PB_String_NoCase)
    
    If Len(SecondStartKeyword) > 0
      If FindString(text$,SecondStartKeyword,0,#PB_String_NoCase)
        Switches(StartKeyWord+EndKeyword) + 1
      EndIf
    Else
      Switches(StartKeyWord+EndKeyword) + 1
    EndIf
    
  EndIf
  
  ProcedureReturn Text$
EndProcedure

Procedure RegexExtract(text$,List ExtractionsResults.s(),Regex)
  If ExamineRegularExpression(Regex,text$)
    While NextRegularExpressionMatch(Regex)
      AddElement(ExtractionsResults())
      ExtractionsResults() = RegularExpressionGroup(Regex, 1)
    Wend
  EndIf
EndProcedure
  
Procedure RegexMatchLineExtract(text$,List ExtractionsResults.s(),Regex)
  If ExamineRegularExpression(Regex,text$)
    If NextRegularExpressionMatch(Regex)
      If text$ = RegularExpressionGroup(Regex, 1)
        AddElement(ExtractionsResults())
        ExtractionsResults() = RegularExpressionGroup(Regex, 2)
      EndIf
    EndIf
  EndIf
EndProcedure

Procedure ArrayExtractionProcedure(text$,List Results.s())
  text$ = Trim(text$,Chr(9))
  
  If UCase(Left(text$,4)) = UCase("Dim ")
    Arrays$ = Mid(text$,5)
    For x = 1 To CountString(Arrays$,",")+1
      AddElement(results())
      Results() = StringField(Arrays$,x,",")
    Next
  EndIf
  
EndProcedure

Procedure.s ReplaceObfString(text.s,SearchString.s,ReplaceString.s)
  returntext.s = text
  
  Repeat
    pos = FindString(returntext,SearchString,pos+1,#PB_String_NoCase)
    If pos > 0
      snippet$ = Mid(returntext,pos,Len(SearchString))
      returntext = ReplaceString(returntext,snippet$,ReplaceString)
    EndIf
  Until pos <= 0
  ProcedureReturn returntext
EndProcedure

Procedure SortByStringLength_SLOW(List SortList_temp.s(),StrictCase=0)
  NewMap Stringlength()
  longest = 0
  ForEach SortList_temp()
    If Len(SortList_temp()) > longest
      longest = Len(SortList_temp())
    EndIf
    If StrictCase = 1
      Stringlength(SortList_temp()) = Len(SortList_temp())
    Else
      Stringlength(UCase(SortList_temp())) = Len(SortList_temp())
    EndIf 
  Next
  ClearList(SortList_temp())
  For x = 0 To longest
    ForEach Stringlength()
      If Stringlength() = x
        AddElement(SortList_temp()) 
        If StrictCase = 1
          SortList_temp() = MapKey(Stringlength())
        Else
          SortList_temp() = ULcase(MapKey(Stringlength()))
        EndIf
          
      EndIf
    Next
  Next
  
EndProcedure

ctext.s

Usage$ = "VBA_AiDe [Options] [VBA-file] [Result-file]"+#LF$
Usage$ + "Options:"+#LF$
Usage$ + "/vars"+Chr(9)+"output variable-names"+#LF$
Usage$ + "/func"+Chr(9)+"output found function, class and sub-names"+#LF$
Usage$ + "/array"+Chr(9)+"output found array-names"+#LF$
Usage$ + "/ai"+Chr(9)+"auto-indent the result"+#LF$
Usage$ + "/de"+Chr(9)+"deobfuscate Upper-/LowerCase"+#LF$
Usage$ + "/do"+Chr(9)+"deobfuscate one-liner"+#LF$
Usage$ + "/cl"+Chr(9)+"reads string from clipboard and writes the result back"+#LF$
Usage$ + "/ve"+Chr(9)+"verbose - print status messages"+#LF$
Usage$ + "/h"+Chr(9)+"Usage"+#LF$
Usage$ +#LF$
Usage$ + "Example:"+ #LF$
Usage$ + "VBA_AiD /aide testfile.vba resultfile.txt"+ #LF$
Usage$ + "VBA_AiD -aidevarsfuncarraydocl"

OpenConsole("VBA AutoIndent & Deobfuscator")

If CountProgramParameters() = 0
  PrintN(Usage$)
  End
EndIf
t = ElapsedMilliseconds()
oneparam$ = "" : file1.s = "" : file2.s = ""
For x = 0 To CountProgramParameters()
  If FileSize(GetPathPart(ProgramParameter(x))) = -2
    If file1 = ""
      file1 = ProgramParameter(x)
    Else
      file2 = ProgramParameter(x)
    EndIf
  Else
    oneparam$ + ProgramParameter(x)
  EndIf
Next

If FindString(oneparam$,"vars",1,#PB_String_NoCase) : PrintVars = 1:EndIf
If FindString(oneparam$,"func",1,#PB_String_NoCase) : PrintFuncs = 1:EndIf
If FindString(oneparam$,"array",1,#PB_String_NoCase) : PrintArray = 1:EndIf
If FindString(oneparam$,"ai",1,#PB_String_NoCase) : AutoIndent = 1:EndIf
If FindString(oneparam$,"de",1,#PB_String_NoCase) : Deobf = 1:EndIf
If FindString(oneparam$,"do",1,#PB_String_NoCase) : DeobfOneLine = 1:EndIf
If FindString(oneparam$,"cl",1,#PB_String_NoCase) : Clipboard = 1:EndIf
If FindString(oneparam$,"ve",1,#PB_String_NoCase) : Verbose = 1:EndIf
If FindString(oneparam$,"h",1,#PB_String_NoCase) 
  PrintN(Usage$)
  End
EndIf
If Verbose=1:PrintN("Loading Input"):EndIf
If Clipboard = 1
  ctext = GetClipboardText()
  
Else
  If file1 = "" Or FileSize(file1) <= 0
    PrintN("Error, no file specified"+#LF$+Usage$)
   Else
    f = ReadFile(#PB_Any,file1)
    While Eof(f) = 0
      ctext + ReadString(f)+#LF$
    Wend
    CloseFile(f)
  EndIf
EndIf

If Left(ctext,27) = "<%@language=VBScript.Encode"
  PrintN("Warning: VBE-Encoding detected. I cannot handle that.")
  PrintN("Maybe https://github.com/JohnHammond/vbe-decoder can help you.")
  PrintN("Trying my best anyway...")
EndIf

If Verbose=1:PrintN("Extract Strings to preserve case-sensitve"):EndIf
NewList SavedStrings.s()
newtext.s = ""
If DeobfOneLine = 1
  For x = 0 To CountString(ctext,Chr(34))
    If x%2 = 0
      Syntax$ = StringField(ctext,x+1,Chr(34))
      newtext.s+ReplaceString(Syntax$,":",#LF$)
    Else
      String$= StringField(ctext,x+1,Chr(34))
      AddElement(SavedStrings())
      SavedStrings() = Chr(34)+String$+Chr(34)
      newtext.s+Chr(34)+String$+Chr(34)
    EndIf
  Next
  ctext = newtext
  ctext + StringField(ctext,x+1,Chr(34))
EndIf

If Verbose=1:PrintN("Un-Case Syntax for later regex."):EndIf
If Deobf = 1
  ForEach VBASyntax()
    ctext = ReplaceObfString(ctext,VBASyntax(),ULcase(VBASyntax()) )
  Next
ElseIf Deobf = 0
  ForEach VBABasicSyntax()
    ctext = ReplaceObfString(ctext,VBABasicSyntax(),ULcase(VBABasicSyntax()))
  Next
EndIf

If Verbose=1:PrintN("Create Regexs"):EndIf
NewList Functions.s()
functionsNameRegex = CreateRegularExpression(#PB_Any,"(?:Function|Sub) (\w+)\(.*\)")

NewList VoidFunctions.s()
vfunctionsNameRegex = CreateRegularExpression(#PB_Any,"(Sub (\w+)\s*\t*\(?\)?)")

NewList Arrays.s()

NewList Variables.s()
VarNameRegex = CreateRegularExpression(#PB_Any,"(?:Set )?(\w+)=")

NewList objects.s()
ObjectRegex = CreateRegularExpression(#PB_Any,"\n\t*(?:Const )?(\w+)[\(\.=]")

line.s 
result.s 


If Verbose=1:PrintN("Replace Else If to Else\nIf"):EndIf
    ;Special Case Else IF are NOT Elif but Else{If()...}
ctext = ReplaceString(ctext,"Else If","Else"+#LF$+"If")


If Verbose=1:PrintN("Indent Line by line"):EndIf
For x = 1 To CountString(ctext, #LF$)+2
  
  If Verbose=1 And x%10 = 0 :Print("Line "+Str(x)+"..."):EndIf
  
  If Verbose=1 And x%10 = 0 :Print("extract..."):EndIf
  RegexExtract(line,Functions(),functionsNameRegex)
  RegexMatchLineExtract(line,VoidFunctions(),vfunctionsNameRegex)
  ArrayExtractionProcedure(line,Arrays())
  RegexExtract(line,objects(),ObjectRegex)
  RegexExtract(line,Variables(),VarNameRegex)
  
  
  If Verbose=1 And x%10 = 0 :Print("indent..."):EndIf
  line = StringField(ctext,x,#LF$)
  If AutoIndent
    line = LTrim(line,Chr(9))
    line = LTrim(line," ")
    
    line = Indent(line,"Class","End Class")
    line = Indent(line,"Function","End Function")
    line = Indent(line,"Private Function","End Function")
    line = Indent(line,"Public Function","End Function")
    line = Indent(line,"Private Function","End Function")
    line = Indent(line,"Public Function","End Function")
    line = Indent(line,"Sub","End Sub")
    line = Indent(line,"Private Sub","End Sub")
    line = Indent(line,"Public Sub","End Sub")
    line = Indent(line,"If","End If","","","Else")
    line = Indent(line,"For","Next","To")
    line = Indent(line,"For Each","Next")
    line = Indent(line,"Select Case","End Select","","","Case",1)
  EndIf
  
  If Verbose=1 And x%10 = 0 :Print("merge..."):EndIf
  result + line+#LF$
Next



If Verbose=1:PrintN("Merge void Functions with normal Functions"):EndIf
MergeLists(VoidFunctions(),Functions())


If Verbose=1:PrintN("Print Arrays"):EndIf
If PrintArray = 1
  SortByStringLength_SLOW(Arrays())
  PrintN("Found Arrays: ")
  ForEach Arrays()
    If ListIndex(Arrays()) < ListSize(Arrays())
      Print(Arrays()+", ")
    Else
      Print(Arrays())
    EndIf
  Next
  PrintN("")
EndIf


If Verbose=1:PrintN("Print Vars"):EndIf
If PrintVars = 1
  SortByStringLength_SLOW(Variables())
  PrintN("Found Variables: ")
  ForEach Variables()
    If ListIndex(Variables()) < ListSize(Variables())
      Print(Variables()+", ")
    Else
      Print(Variables())
    EndIf
  Next
  PrintN("")
EndIf


If Verbose=1:PrintN("Print Funcs"):EndIf
If PrintFuncs = 1
  SortByStringLength_SLOW(Functions())
  PrintN("Found Functions: ")
  ForEach Functions()
    If ListIndex(Functions()) < ListSize(Functions())
      Print(Functions()+", ")
    Else
      Print(Functions())
    EndIf
  Next
  PrintN("")
EndIf


If Verbose=1:PrintN("Merge all Objects into on replacement-list"):EndIf
MergeLists(Functions(),objects())
MergeLists(Variables(),objects())
MergeLists(Arrays(),objects())
MergeLists(VBASyntax(),objects())

If Verbose=1:PrintN("Sort and Optimize list(slow!)"):EndIf
SortByStringLength_SLOW(objects())


If Verbose=1:PrintN("Deobfuscate Objects, Funcs, Vars..."):EndIf
If Deobf = 1
  ForEach objects()
    result = ReplaceObfString(result,objects(),ULcase(objects()) )
  Next
EndIf


If Verbose=1:PrintN("Restore original strings"):EndIf
;Backup Strings
SortByStringLength_SLOW(SavedStrings(),1)
ForEach SavedStrings()
 result = ReplaceObfString(result,SavedStrings(),SavedStrings())
Next


If Verbose=1:PrintN("Write result to output"):EndIf
If Clipboard = 1
  SetClipboardText(result)
Else
  If Len(file2) > 0
    f = CreateFile(#PB_Any,file2)
    WriteString(f,result)
    CloseFile(f)
  EndIf
EndIf
PrintN("Finished.")

If Verbose=1:PrintN("Time needed: "+Str(ElapsedMilliseconds() - t)+" ms"):EndIf
; IDE Options = PureBasic 6.00 LTS (Windows - x64)
; ExecutableFormat = Console
; CursorPosition = 447
; FirstLine = 441
; Folding = B5
; EnableXP
; DPIAware
; UseIcon = indentation.ico
; Executable = VBA_AiD.exe
; CommandLine = -aidevarsfuncarraydocl